<!--
Google IO 2012 HTML5 Slide Template

Authors: Eric Bidelman <ebidel@gmail.com>
         Luke Mahé <lukem@google.com>

URL: https://code.google.com/p/io-2012-slides
-->
<!DOCTYPE html>
<html>
<head>
  <title>Google IO 2012</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <!--This one seems to work all the time, but really small on ipad-->
  <!--<meta name="viewport" content="initial-scale=0.4">-->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" media="all" href="theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="theme/css/phone.css">
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  <script data-main="js/slides" src="js/require-1.0.8.min.js"></script>
</head>
<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="logoslide nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/logo_devfest.png"></span>
    </article>
  </slide>

  <slide class="title-slide segue nobackground">
    <aside class="gdbar"><img src="images/google_developers_icon_128.png"></aside>
    <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
    </hgroup>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar"><img src="images/google_developers_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Agenda</h2>
    </hgroup>
    <article style="margin-left:450px;">
      <h4 class="blue" style="margin-bottom:50px;">Introducción a HTML 5 APIs</h4>
      <div class="white">
        <ul>
          <li>XMLHttpRequest V2</li>
          <li>File API</li>
          <li>File System API<li>
          <li>File Writer</li>
          <li>Indexed DataBase API</li>
          <li>IDLs</li>
          <li>Elemental</li>
          <li>Google Dart</li>
        </ul>
      </div>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>XMLHTTPRequest V2</h2>
      <h3>Novedades</h3>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="javascript">
var xhr = new XMLHttpRequest();
xhr.open('GET', '/path/to/image.png', true);
<b>xhr.responseType = 'arraybuffer';</b>

xhr.onload = function(e) {
  if (this.status == 200) {
    //this.response //TODO Respuesta del servidor 
  }
};
xhr.send();
    </pre>
    <p style="font-size:14px"><b>xhr.responseType:</b><span> Antes de enviar la solicitud, se debe poner en xhr.responseType alguno de los siguientes valores  "text", "arraybuffer", "blob" o "document", segun los datos que se necesiten traer desde el servidor. Si se omite el valor en xhr.responseType o este es igual a '', se utilizará la respuesta predeterminada "text".</span></p>
    <p style="font-size:14px"><b>xhr.response:</b><span> Si la solictud es correcta, la propiedad <b>response</b> de xhr contendrá los datos solicitados como: <b>DOMString, ArrayBuffer, Blob o Document</b> (segun el valor establecido en responseType).</p>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>XMLHTTPRequest V2</h2>
      <h3>Enviando y recibiendo datos</h3>
    </hgroup>
    <article class="smaller centered">
      <table>
        <tr>
          <th>Antes de HTML5</th><th>Ahora!!!</th>
        </tr>
        <tr>
          <td>DOMString</td><td>DOMString</td>
        </tr>
        <tr>
          <td>Document(XML)</td><td>Document(XML)</td>
        </tr>
        <tr>
          <td></td><td class="highlight">ArrayBuffer</td>
        </tr>
        <tr>
          <td></td><td class="highlight">Blob</td>
        </tr>
        <tr>
          <td></td><td class="highlight">File</td>
        </tr>
        <tr>
          <td></td><td class="highlight">FormData</td>
        </tr>
      </table>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>XMLHttpRequest V2</h2>
      <h3>Enviando y Reciviendo datos</h3>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="javascript">
var xhr = new XMLHttpRequest();
xhr.open('GET', 'http://localhost:8888/resource', true);
xhr.responseType = 'blob';

xhr.onload = function(e) {
  if (this.status == 200) {
    var blob = this.response;

    var url = window.URL.createObjectURL(blob);
    console.log(url);
    window.URL.revokeObjectURL(url);
    
  }
};
xhr.send();
    </pre>
    <!--button id="send">Dame un Blob!!!</button-->
    <script type="text/javascript">
      document.querySelector('[id=send]').addEventListener("click", function(evt){
        var xhr = new XMLHttpRequest();
        xhr.open('GET', 'http://samples-of-html5.appspot.com/resource', true);
        xhr.responseType = 'blob';

        xhr.onload = function(e) {
          console.log(e);
          if (this.status == 200) {
            var blob = this.response;

            var url = window.URL.createObjectURL(blob);
            console.log(url);
            window.URL.revokeObjectURL(url);
          }
      };
      xhr.send();
      }, false);
    </script>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>File API</h2>
      <h3>Componentes</h3>
    </hgroup>
    <article class="smaller">
      <table>
        <tr>
          <td>File</td><td>El objeto File provee información sobre el Archivo, este Objeto generalmente es obtenido desde el FileList, DataTransfer o creado con el FileSystem API</td>
        </tr>
        <tr>
          <td>FileList</td><td>Este objeto es obtenido desde la propiedad <b>files</b> del elemento input</td>
        </tr>
        <tr>
          <td>Blob</td><td>Este objeto representa información binaria inmutable y permite acceso a rangos de bytes dentro del Blob, pero en Blobs separados</td>
        </tr>
        <tr>
          <td>FileReader</td><td>Provee métodos para la lectura de File y Blob</td>
        </tr>
        <tr>
          <td>URI Scheme</td><td>Se utilizan datos binarios como archivos, por lo que puden ser referenciados desde la app web.<br>
         Por ejemplo: <b>blob:550e8400-e29b-41d4-a716-446655440000#aboutABBA</b>, puede ser utilizado en el atributo <b>src</b> del elemento <b>img</b></td>
        </tr>
      </table>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>File API</h2>
      <h3><span class="blue">Recuperando Archivos</span> => File / FileList</h3>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="html">
  &lt;input type="file" id="files" name="files[]" multiple />
      </pre>
      <pre class="prettyprint" data-lang="javascript">
//Existe soporte de File API
if (window.File && window.FileReader && window.FileList && window.Blob) {
  // Success!!
} else {
  alert('File API no esta soportada por el navegador');
}
function onChange(evt) {
    var files = evt.target.files; // Objeto FileList
    var output = [];
    for (var i = 0, f; f = files[i]; i++) {
      output.push('&lt;li&gt;&lt;strong&gt;', escape(f.name), '&lt;/strong&gt; (', f.type || 'n/a', ') - ', f.size, ' bytes, last modified: ',
                  f.lastModifiedDate.toLocaleDateString(), '&lt;/li&gt;');
    }
    document.getElementById('list').innerHTML = '&lt;ul&gt;' + output.join('') + '&lt;/ul&gt;';
  }
  document.getElementById('files').addEventListener('change', onChange, false);
    </pre>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
    <h3><span class="blue">Drag And Drop</span> => File / FileList</h3>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="html">
        &lt;div id="drop_zone">Drop files here&lt;/div>
        &lt;output id="list">&lt;/output>
      </pre>
      <pre class="prettyprint" data-lang="javascript">
function onDrop(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    <b>var files = evt.dataTransfer.files; // Objecto FileListb</b>
    var output = [];
    for (var i = 0, f; f = files[i]; i++) {
      <b>//TODO f.name, f.size, f.lastModifiedDate, f.type</b>
    }
    document.getElementById('list').innerHTML = '&lt;ul>' + output.join('') + '&lt;/ul>';
  }
  function onDragOver(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    evt.dataTransfer.dropEffect = 'copy';
  }
}
      </pre>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
    <h2>File API - Ejemplos</h2>
    <h3><span class="blue">Importar / Drag And Drop</span></h3>
    </hgroup>
    <article class="smaller">
      <div style="padding: 10px; border: 1px solid #CCC;">
        <input type="file" id="files" name="files[]" multiple />
        <output id="list"></output>
      </div>
      <div id="drag-zone" style="-webkit-justify-content:center; display: -webkit-flex; -webkit-align-items: center;margin-top:40px; height:100px; padding: 25px; border: 1px solid #CCC;">Arrastre los archivos aquí</div>
      <output id="list-drop"></output>

        <script type="text/javascript">
          document.addEventListener("change", onChange, false);
          document.querySelector('[id="drag-zone"]').addEventListener("drop", onDrop, false);
          var output = [];
          function onChange(evt){
            output = [];
            var files = evt.target.files;
            for (var i = 0, f; f = files[i]; i++) {
              write(f);
            }
            document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';
          }

          function onDrop(evt){
            evt.stopPropagation(); // Stops some browsers from redirecting.
            evt.preventDefault();
            output = [];
            var length = evt.dataTransfer.files.length;
            for (var i = 0; i < length; i++) {
              var file = evt.dataTransfer.files[i];
              write(file);
            }
            document.getElementById('list-drop').innerHTML = '<ul>' + output.join('') + '</ul>';
          }

          function write(f){
            output.push('<li style="font-size:12px;margin-top:10px;"><b>', escape(f.name), '</b> (', f.type || 'n/a', ') - ',
                  f.size, ' bytes, modificado: ',
                  f.lastModifiedDate.toLocaleDateString(), '</li>');
          }
        </script>
    </article>
  </slide>


  <slide class="nobackground">
    <hgroup>
      <h2>File API</h2>
      <h3><span class="blue">FileReader</span></h3>
    </hgroup>
    <article>
     <table>
        <tr>
          <td>FileReader.readAsBinaryString(Blob|File)</td><td>La propiedad result contendra la informacon del File o Blob como un String binario.</td>
        </tr>
        <tr>
          <td>FileReader.readAsText(Blob|File, opt_encoding)</td><td>La propiedad result contendra la informacon del File o Blob como un string de texto, por defecto el string es codificado en UTF-8.</td>
        </tr>
        <tr>
          <td>FileReader.readAsDataURL(Blob|File)</td><td>La propiedad result contendra el contenido del Blob o File codificado como una URL data<br><b>data:[&lt;MIME-type>][;charset=&lt;encoding>][;base64],&lt;data></b></td>
        </tr>
        <tr>
          <td>FileReader.readAsArrayBuffer(Blob|File)</td><td>La propiedad result contendra el contenido del Blob o File como un ArrayBuffer</td>
        </tr>
      </table>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>Data URL & Blob URL</h2>
    </hgroup>
    <article class="smaller">
      <table>
        <tr>
          <td>Data URL</td><td>data:[&lt;mediatype>][;base64],&lt;data></td>
        </tr>
        <tr>
          <td>Blob URL</td><td>window.URL.createObjectURL(), window.URL.revokeObjectURL(). 
          <br>Se puede acceder a las URL de Blobs creados en Chrome en la siguiente URL <a href="chrome://blob-internals/" target="_blank">chrome://blob-internals/</a></td>
        </tr>
      </table>
      <br>
      <pre class="prettyprint" data-lang="javascript">
var linkCss  = document.createElement('link');
linkCss.rel  = 'stylesheet';
<b>linkCss.href = 'data:text/css;base64,' +
            window.btoa('body { background: red;  }');</b>

document.head.appendChild(linkCss);
      </pre>
      <pre class="prettyprint" data-lang="javascript">
window.URL = window.URL || window.webkitURL;

var blob = new Blob(['body { color: red; }'], {type: 'text/css'});

var linkCss = document.createElement('link');
linkCss.rel = 'stylesheet';
<b>linkCss.href = window.URL.createObjectURL(blob);</b>
document.body.appendChild(linkCss);
      </pre>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>File System API (Asynchronous APIs)</h2>
      <h3 class="blue"><a href="http://dev.w3.org/2009/dap/file-system/pub/FileSystem/#data-persistence-and-accessing-the-api">File API: Directories and System</a></h3>
    </hgroup>
    <article class="smaller">
      <p>El API de File System, simula un file system local que las aplicaciones web pueden navegar e interactura. Utilizando esta podrán hacer aplicaciones que lean, escriban, creen archivos y directorios en el Sistema de Archivos virtual.</p>
      <p>Este API interactúa con otras APIs relacionadas, por ejemplo <a href="http://www.w3.org/TR/file-writer-api/">File Writer API</a> que esta construida sobre <a href="http://www.w3.org/TR/FileAPI/#dfn-file">File API</a>, cada API agrega funcionalidades particulares</p>
     
      <table>
        <tr>
            <td>LocalFileSystem</td><td>Tiene dos métodos globales para el acceso al FileSystem: <b>requestFileSystem()</b> y <b>resolveLocalFileSystemURL()</b> </td>
          </tr>
          <tr>
            <td>FileSystem</td><td>Representa el FileSystem</td>
          </tr>
          <tr>
            <td>Entry</td><td>Representa una entrada del FileSystem</td>
          </tr>
          <tr>
            <td>DirectoryEntry</td><td>Representa una entrada de Directorio en el FileSystem</td>
          </tr>
          <tr>
            <td>DirectoryReader</td><td>Por medio de éste podremos listar los archivos y directorios de un directorio</td>
          </tr>
          <tr>
            <td>FileError</td><td>Este objeto es el que contedrá el error en el caso que exista uno en el procesamiento de los método asincrónicos</td>
          </tr>
        </table>
    </article>
  </slide>

  <slide class="nobackground">
    <aside class="note">
      <section>
        <ul>
          <li>Métodos de la clase Entry</li>
        </ul>
      </section>
    </aside>
    <hgroup>
      <h2>File System API (Asynchronous APIs)</h2>
      <h3 class="blue">Entry Metodos</h3>
    </hgroup>
    <article>
      <table class="smaller">
        <tr>
            <td>void getMetada (in MetadataCallback successCallback, in optional ErrorCallback errorCallback);</td>
          </tr>
          <tr>
            <td>void moveTo (in DirectoryEntry parent, optional DOMString newName, in optional EntryCallback successCallback, in optional ErrorCallback errorCallback);</td>
          </tr>
          <tr>
            <td>void copyTo (in DirectoryEntry parent, in optional DOMString newName, in optional EntryCallback successCallback, in optional ErrorCallback errorCallback);</td>
          </tr>
          <tr>
            <td>void toURL (in optional DOMString mimeType);</td>
          </tr>
          <tr>
            <td>void remove (in VoidCallback successCallback, in optional ErrorCallback errorCallback);</td>
          </tr>
          <tr>
            <td>void getParent (in EntryCallback successCallback, in optional ErrorCallback errorCallback);</td>
          </tr>
        </table>
    </article>
  </slide>

  <slide class="nobackground">
    <aside class="note">
      <section>
        <ul>
          <li>Iniciar chrome con --unlimited-quota-for-files, posibilita tamaño ilimitado</li>
          <li>Si es extensión de Google Chrome, en el manifest unlimitedStorage </li>
          <li>Si estamos trabajando con el protocolo file://  iniciar chrome con --allow-file-access-from-files y no tendremos ninguno de estos errores: SECURITY_ERR y QUOTA_EXCEEDED_ERR  </li>
        </ul>
      </section>
    </aside>
    <hgroup>
      <h2>File System API (Asynchronous APIs)</h2>
      <h3>Abriendo el FileSystem</h3>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="javascript">
window.requestFileSystem(window.TEMPORARY, 5 * 1024 * 1024, function(
      filesystem) {
  fs = filesystem;
  loadFs();
}, errorHandler);
      </pre>
      <pre class="prettyprint" data-lang="javascript">
window.webkitStorageInfo.requestQuota(PERSISTENT, 15 * 1024 * 1024,
      function(grantedBytes) {
        window.requestFileSystem(PERSISTENT, grantedBytes, function(
            filesystem) {
          fs = filesystem;
          actualDirectory = fs.root;
          loadFs();
        }, errorHandler);
      }, errorHandler);
      </pre>
    </article>
  </slide>

  <slide class="nobackground">
    <aside class="note">
      <section>
        <ul>
          <li>Métodos de la clase DirectoryEntry</li>
        </ul>
      </section>
    </aside>
    <hgroup>
      <h2>File System API (Asynchronous APIs)</h2>
      <h3 class="blue">DirectoryEntry Metodos</h3>
    </hgroup>
    <article>
      <table class="smaller">
        <tr>
            <td>DirectoryReader createReader ();</td>
          </tr>
          <tr>
            <td>void getFile (in DOMString path, in optional Flags options, in optional EntryCallback successCallback, in optional ErrorCallback errorCallback);</td>
          </tr>
          <tr>
            <td>void getDirectory (in DOMString path, in optional Flags options, in optional EntryCallback successCallback, in optional ErrorCallback errorCallback);</td>
          </tr>
          <tr>
            <td>void removeRecursively (in Void Callback successCallback, in optional ErrorCallback errorCallback);</td>
          </tr>
        </table>
    </article>
  </slide>

  <slide class="nobackground">
    <aside class="note">
      <section>
        <ul>
          <li>Acceso y creación de directorios</li>
          <li>Opciones de creación</li>
        </ul>
      </section>
    </aside>
    <hgroup>
      <h2>File System API (Asynchronous APIs)</h2>
      <h3>Creando y Obteniendo Directorios</h3>
    </hgroup>
    <article class="smaller" style="margin-top:0px">
      <pre class="prettyprint" data-lang="javascript">
function onFs(fs){
  fs.root.getDirectory('Documents', {create:true}, function(directoryEntry){
    //directoryEntry.isFile === false
    //directoryEntry.isDirectory === true
    //directoryEntry.name === 'Documents'
    //directoryEntry.fullPath === '/Documents'
    }, errorHandler);
  }
      </pre>
      <table class="smaller">
        <tr><th>Literal</th><th>Condición</th><th>Resultado</th></tr>
        <tr>
            <td class="small">create: true<br>
                exclusive:true</td><td>Existe el Path</td><td>Un error es lanzado</td>
          </tr>
          <tr>
            <td class="small">create: true<br>
                exclusive: false</td><td>Si el path no existe y no ocurre otro error</td><td>El directorio es y ningún error es lanzado</td>
          </tr>
          <tr>
            <td class="small">create: false<br>
                (exclusive is ignored)</td><td>Si el Path existe</td><td>El directorio es creado</td>
          </tr>
          <tr>
            <td class="small">create: false<br>
                (exclusive is ignored</td><td>Si el Path no existe</td><td>Un error es lanzado</td>
          </tr>
          <tr>
            <td class="small">create: false<br>
                (exclusive is ignored)</td><td>Si el path existe y es un directorio</td><td>Un error es lanzado</td>
          </tr>
        </table>
    </article>
  </slide>

  <slide class="nobackground">
    <aside class="note">
      <section>
        <ul>
          <li>Métodos de la clase FileEntry</li>
        </ul>
      </section>
    </aside>
    <hgroup>
      <h2>File System API (Asynchronous APIs)</h2>
      <h3 class="blue">FileEntry Metodos</h3>
    </hgroup>
    <article>
      <table class="smaller">
        <tr>
            <td>void createWriter (FileWriterCallback successCallback, optional ErrorCallback errorCallback);</td>
          </tr>
          <tr>
            <td>void file (FileCallback successCallback, optional ErrorCallback errorCallback);</td>
          </tr>
        </table>
    </article>
  </slide>
  
  <slide class="nobackground">
    <aside class="note">
      <section>
        <ul>
          <li>Acceso y creación de directorios</li>
          <li>Opciones de creación</li>
        </ul>
      </section>
    </aside>
    <hgroup>
      <h2>File System API (Asynchronous APIs)</h2>
      <h3>Creando y Obteniendo Directorios</h3>
    </hgroup>
    <article class="smaller" style="margin-top:0px">
      <pre class="prettyprint" data-lang="javascript">
function onInitFs(fs) {
   fs.root.getFile('log.txt', {create: true}, function(fileEntry) {
     // Crea un Objeto FileWriter 
    <b>fileEntry.createWriter(function(fileWriter)</b> {
       fileWriter.onwriteend = function(e) {
        console.log('Write completed.');
      };
       fileWriter.onerror = function(e) {
        console.log('Write failed: ' + e.toString());
      };
       <b>var blob = new Blob([ 'Creamos nuestro File!!!!!!!' ], {
        type : 'text/plain'
      });</b>
      <b>fileWriter.write(blob);</b>
    }, errorHandler);
  }, errorHandler);
}
      </pre>
    </article>
  </slide>

  <slide class="nobackground">
    <aside class="note">
      <section>
        <ul>
          <li>Lo mismo se puede hacer en la seleccion de Archivos</li>
        </ul>
      </section>
    </aside>
    <hgroup>
      <h2>File System API (Asynchronous APIs)</h2>
      <h3>Importando Directorios</h3>
    </hgroup>
    <article  class="smaller">
      <pre class="prettyprint" data-lang="html">
&lt;input type="file" multiple webkitdirectory="" mozdirectory="" directory="">
      </pre>
      <pre class="prettyprint" data-lang="javascript">
function onChange(e) {
  e.stopPropagation();
  e.preventDefault();

  var entries = e.target.webkitEntries; // Tenemos todas como Entradas (Entry).

  [].forEach.call(entries, function(entry) {

    // Copia la entrada al FS
    entry.copyTo(fs.root, null, function(copiedEntry) {
      //TODO
    }, onError);

  });
}        
      </pre>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>File System API (Asynchronous APIs)</h2>
      <h3>Drag and Drop Directorios</h3>
    </hgroup>
    <article  class="smaller">
      <pre class="prettyprint" data-lang="javascript">
function onDrop(e) {
  e.preventDefault();
  e.stopPropagation();

  var items = e.dataTransfer.items;

  for (var i = 0, item; item = items[i]; ++i) { 
    var entry = item.webkitGetAsEntry();

    // Si es un directorio copia la Entrada al FS
    if (entry.isDirectory) {
      entry.copyTo(fs.root, null, function(copiedEntry) {
        // TODO
      }, errorHandler);
    }
  }
}       
      </pre>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>FileSystem URL</h2>
    </hgroup>
    <article class="smaller" style="margin-top:5px;">
      <ol>
        <li style="text-decoration:line-through;">Blob URL</li>
        <li style="text-decoration:line-through;">Data URL</li>
        <li>FileSystem URL</li>
      </ol>
      <pre class="prettyprint" data-lang="javascript">
// filesystem:http://&lt;origin>/&lt;temporary|persistent>/&lt;resource.png
...        
case 'image/jpeg':
      var img = document.createElement('img');
      <b>img.src = fileEntry.toURL();</b>
      meta.appendChild(img);
      break;   
...   

window.resolveLocalFileSystemURL = window.resolveLocalFileSystemURL
    || window.webkitResolveLocalFileSystemURL;
...   
<b>window.resolveLocalFileSystemURL(fileSystemPath + path,
      function(dirEntry)</b> {
        var dirReader = dirEntry.createReader();
        var dirs = [];
        dirReader.readEntries(function(dirs) {
          //TODO
        }, errorHandler);
      }, errorHandler);
...
      </pre>
    </article>
  </slide>

  <slide class="fill nobackground" style="background-image: url(images/sky.jpg)">
    <div class="flexbox vcenter">
      <h2 class="white centered"><a href="http://samples-of-html5.appspot.com/explorer.html"> Demo</a></h2>
      <img class="centered" src="images/HTML5_Offline_Storage_128"/>
    </div>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>Indexed DB</h2>
      <h3><a href="http://www.w3.org/TR/IndexedDB/">Especificación</a></h3>
    </hgroup>
    <article class="smaller" style="margin-top:0px;">
      <p>IndexedDB es un API para almacenamiento de cantidades significativas de iformación estructurada en el cliente. Tiene una gran eficiencia debido a que hace uso de indices para traer la información.
    </article>
    <table>
        <tr>
            <td style="padding: 10px 0.5em; font-size:12px">IDBFactory</td><td style="padding: 5px 0.5em; font-size:12px">Provee acceso a la Base de Datos</td>
          </tr>
          <tr>
            <td style="padding: 10px 0.5em; font-size:12px">IDBCursor</td><td style="padding: 5px 0.5em; font-size:12px">Permite la iteración sobre los objetos guardados e Indices</td>
          </tr>
          <tr>
            <td style="padding: 10px 0.5em; font-size:12px">IDBDatabase</td><td style="padding: 5px 0.5em; font-size:12px">Representa una conexión a la Base de Datos</td>
          </tr>
          <tr>
            <td style="padding: 10px 0.5em; font-size:12px">IDBEnvironment</td><td style="padding: 5px 0.5em; font-size:12px">Provee acceso a la base de datos, window implementa esta interface.  </td>
          </tr>
          <tr>
            <td style="padding: 10px 0.5em; font-size:12px">IDBIndex</td><td style="padding: 5px 0.5em; font-size:12px">Provee acceso asincrónico a los Indeces definidos. Éste es un objeto que guarda una referencia a otro objeto.</td>
          </tr>
          <tr>
            <td style="padding: 10px 0.5em; font-size:12px">IDBKeyRange</td><td style="padding: 5px 0.5em; font-size:12px">Permite la definición de un rago de claves</td>
          </tr>
          <tr>
            <td style="padding: 10px 0.5em; font-size:12px">IDBObjectStore</td><td style="padding: 5px 0.5em; font-size:12px">Representa un objeto de almacenamiento en la DB. Todos los registros en el ObjectStore son ordenados según sus claves.</td>
          </tr>
          <tr>
            <td style="padding: 10px 0.5em; font-size:12px">IDBOpenDBRequest</td><td style="padding: 5px 0.5em; font-size:12px">Representa el request de apertura de la DB</td>
          </tr>
          <tr>
            <td style="padding: 10px 0.5em; font-size:12px">IDBRequest </td><td style="padding: 5px 0.5em; font-size:12px">Provee acceso asincrónico a los resultados de los request realizados a la DB y a los object stores.</td>
          </tr>
           <tr>
            <td style="padding: 10px 0.5em; font-size:12px">IDBTransaction</td><td style="padding: 5px 0.5em; font-size:12px">Representa una transacción, toda operación debe realizarse en un scope de transacción, esta transacción puede ser de lectura o escritura.</td>
          </tr>
        </table>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>Indexed DB</h2>
      <h3>Abriendo la Base de Datos</h3>
    </hgroup>
    <article class="smaller" style="margin-top:5px;">
      <pre class="prettyprint" data-lang="javascript">
window.version = "3";
window.indexedDB = window.indexedDB || window.webkitIndexedDB || window.mozIndexedDB;
var IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction;
var IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange;
window.db = null;

//Abriendo la Base de datos, donde explicitamos la version
var openDBRequest = window.indexedDB.open("myDatabase", window.version);
      </pre>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>Indexed DB</h2>
      <h3 class="blue">Apertura correcta de la DB</h3>
    </hgroup>
    <article class="smaller" style="margin-top:5px;">
      <pre class="prettyprint" data-lang="javascript" style="line-height: 15px;">
    <b>openDBRequest.onsuccess = function(e)</b>{
        try{
            window.db = e.target.result;
            //Si no esta creado es porque no se ejecuto el evento "onupgradeneeded"
            if(!window.db.objectStoreNames.contains("person")){
                <b>var versionRequest = window.db.setVersion(window.version);
                versionRequest.onsuccess = function(e) {
                    var objectStore = window.db.createObjectStore("person", {
                        keyPath: "timeStamp"
                    });
                    objectStore.createIndex("name", "name", {
                        unique: false
                    });
                    objectStore.createIndex("email", "email", {
                        unique: true
                    });
                    e.target.transaction.oncomplete = function(e){
                        console.log("ObjectStore create: Success");
                        loadAllData();
                    }
                }</b>
                versionRequest.onerror = function(e){
                    console.log("Setting version: Error");
                }
            }else{ 
                loadAllData();
            }
        }catch(e){
            console.log(e);
        }
    }
      </pre>
    </article>
  </slide>


  <slide class="nobackground">
    <hgroup>
      <h2>Indexed DB</h2>
      <h3 class="blue">Creando la Estructura</h3>
    </hgroup>
    <article class="smaller" style="margin-top:5px;">
      <pre class="prettyprint" data-lang="javascript">
<b>openDBRequest.onupgradeneeded = function(e)</b>{
    window.db = e.target.result;
    //Creamos la Persona
    if(!window.db.objectStoreNames.contains("person")) {
        var objectStore = window.db.createObjectStore("person", {
            keyPath: "timeStamp"
        });
        objectStore.createIndex("name", "name", {
            unique: false
        });
        objectStore.createIndex("email", "email", {
            unique: true
        });
        console.log("ObjectStore create: Success");
    }
}
      </pre>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>Indexed DB</h2>
      <h3 class="blue">Obteniedo información</h3>
    </hgroup>
    <article class="smaller" style="margin-top:5px;">
      <pre class="prettyprint" data-lang="javascript">
var tran = window.db.transaction(["person"], "readonly");
var obj = tran.objectStore("person");

var cursorRequest = obj.openCursor();
cursorRequest.onsuccess = function(e){
  var cursor = e.target.result;
  if(cursor == false)
    return;
  addRow(cursor.value); //Funcion de usuario para manejo gráfico
  cursor.continue();
};
      </pre>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>Indexed DB</h2>
      <h3 class="blue">Insertando información</h3>
    </hgroup>
    <article class="smaller" style="margin-top:5px;">
      <pre class="prettyprint" data-lang="javascript" style="line-height: 15px;">
var transaction = window.db.transaction(["person"], <b>"readwrite"</b>);

var person = transaction.objectStore("person");
var obj = requestValues(); //Funcion del usuario
var request = person.add({
  "timeStamp":obj.timeStamp,
  "name" : obj.name, 
  "email" : obj.email
});

request.onsuccess = function(e){
  console.log("Request is complete: Success ");
}

request.onerror = function(e){
  console.log("Request is complete: Error ");
}

transaction.oncomplete = function(e) {
  addRow(obj);
};

transaction.onerror = function(e){
  console.log(e);
  console.log("Transaction is complete: Error");
}
      </pre>
    </article>
  </slide>

<slide class="nobackground">
    <hgroup>
      <h2>Indexed DB</h2>
      <h3 class="blue">Borrando información</h3>
    </hgroup>
    <article class="smaller" style="margin-top:5px;">
      <pre class="prettyprint" data-lang="javascript" style="line-height: 15px;">
var trxDelete = window.db.transaction(["person"], "readwrite");
var person = trxDelete.objectStore("person");

<b>var requestDelete = person.delete(id);</b>
requestDelete.onsuccess = function(e){
  //TODO
}

requestDelete.onerror = function(e){
  console.log("Error in requestDelete");
}

trxDelete.oncomplete = function(e){
  console.log("Transaction is complete: Success");
  var trxDelete = window.db.transaction(["person"], "readonly");
  var person = trxDelete.objectStore("person");
  <b>var countRequest = person.count();
    countRequest.onsuccess = function(e){
    var result = e.target.result;
    console.log(result + "deleted");</b>
  }
}
      </pre>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar"><img src="images/google_developers_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>IDLs</h2>
    </hgroup>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>¿Qué es una IDL?</h2>
    </hgroup>
    <article class="smaller">
      <p>Web IDLs se utilizan para describir interfaces en una plataforma Web</p>
      <pre class="prettyprint" data-lang="javascript" style="line-height: 15px;">
exception GraphicsException {
  DOMString reason;
};

interface Paint { };

interface SolidColor : Paint {
  attribute float red;
  attribute float green;
  attribute float blue;
};

interface Pattern : Paint {
  attribute DOMString imageURL;
};

[Constructor]
interface GraphicalWindow {
  readonly attribute unsigned long width;
  readonly attribute unsigned long height;

  attribute Paint currentPaint;

  void drawRectangle(float x, float y, float width, float height);

  void drawText(float x, float y, DOMString text);
};
      </pre>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar"><img src="images/google_developers_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Elemental<h2><br>
      <h4 class="blue"><a href="https://developers.google.com/web-toolkit/articles/elemental">Google Web Toolkit</a></h4>
    </hgroup>
    <article class="smaller white" style="margin-left:350px">
      <p><b><a href="https://developers.google.com/web-toolkit/articles/elemental">Elemental</a></b> es una nueva librería de GWT, rápida y liviana, la cual implementa las IDLs definidas por las especificaciones. </p>
      <p>Ideal para el desarrollo de aplicaciones móviles y aplicaciones web.<p><br>
      <p><b>Elemental</b> incluye todas las características de HTML5:</p>
      <ul>
        <li>DOM access</li>
        <li>WebGL</li>
        <li>WebAudio</li>
        <li>WebSockets</li>
        <li>WebRTC</li>
        <li>File API</li>
        <li>FileSystem API</li>
        <li>IndexedDB API</li>
        <li>y más ...</li>
      </ul>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>Y el Código??</h2>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="java" style="line-height: 15px;">
Console console;
Window window;
Document doc;

public LocalStorage() {
  window = Browser.getWindow();
  doc = window.getDocument();
  console = window.getConsole();
}

@Override
public void onModuleLoad() {
  <b>window.webkitRequestFileSystem(Window.TEMPORARY, 1024 * 1024, new FileSystemCallback()</b> {
    @Override
    public boolean onFileSystemCallback(DOMFileSystem fileSystem) {
      fs = fileSystem;
      loadFs();
      return true;
    }
  }, errorCallback );
}
      </pre>
      <pre class="prettyprint" data-lang="javascript">
<b>window.requestFileSystem(window.TEMPORARY, 5 * 1024 * 1024, function(filesystem)</b> {
  fs = filesystem;
  loadFs();
}, errorHandler);
      </pre>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar"><img src="images/google_developers_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Google Dart<h2><br>
    </hgroup>
    <article class="smaller white" style="margin-left:350px">
      <p><b><a href="http://www.dartlang.org/">Google Dart</a></b> Es un nuevo lenguajes para la Web, basado en clases, con tipado estático opcional, orientado a objetos, closures, etc. Google Dart, le ayudará a construir estructuradas y modernas aplicaciones web.</p>
    </article>
  </slide>

  <slide class="nobackground">
    <hgroup>
      <h2>Y el Código??</h2>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="dart" style="line-height: 15px;">
#import ('dart:html', prefix: 'html');

void initFileSystem(){
  <b>html.window.webkitStorageInfo.requestQuota(html.Window.PERSISTENT, 5*1024*1024, (grantedBytes)</b> {
    <b>html.window.webkitRequestFileSystem(html.Window.PERSISTENT, grantedBytes, (html.DOMFileSystem filesystem)</b>{
      fs = filesystem;
      actualDirectory = fs.root;
      html.window.console.log(fs);
      loadFileSystem();
    }, (e) => errorHandler(e));
  }, (e) => errorHandler(e));
}
      </pre>
      <pre class="prettyprint" data-lang="javascript" style="line-height: 15px;">
<b>window.webkitStorageInfo.requestQuota(PERSISTENT, 15 * 1024 * 1024, function(grantedBytes)</b> {
  <b>window.requestFileSystem(PERSISTENT, grantedBytes, function(filesystem)</b> {
    fs = filesystem;
    actualDirectory = fs.root;
    loadFs();
  }, errorHandler);
}, errorHandler);
      </pre>
    </article>
  </slide>

  <!--slide class="segue dark quote nobackground">
    <aside class="gdbar right bottom"><img src="images/google_developers_icon_128.png"></aside>
    <article class="flexbox vleft auto-fadein">
      <q>
        This is an example of quote text.
      </q>
      <div class="author">
        Name<br>
        Company
      </div>
    </article>
  </slide-->

  <slide class="thank-you-slide segue nobackground">
    <aside class="gdbar right"><img src="images/google_developers_icon_128.png"></aside>
    <article class="flexbox vleft auto-fadein">
      <h2>&lt;Muchas Gracias!!!&gt;</h2>
    </article>
    <p class="auto-fadein" style="margin-top:15px;" data-config-contact >
      <!-- populated from slide_config.json -->
    </p>
  </slide>

  <slide class="logoslide dark nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/logo_devfest.png"></span>
    </article>
  </slide>

  <slide class="backdrop"></slide>

</slides>

<script>
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXXXXX-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>
